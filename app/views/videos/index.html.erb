<h1>All Videos</h1>

<!-- パーシャル化した検索フォームを読み込む -->
<%= render 'search_form' %>

<% if @videos.any? %>
  <% if @videos.first.is_a?(Video) %>
    <!-- データベースからの動画情報の表示 -->
    <ul>
      <% @videos.each do |video| %>
        <li>
          <strong>Title:</strong> <%= video.title %><br>
          <strong>Description:</strong> <%= video.description %><br>
          <%= link_to 'View Details', video_path(video) %>
        </li>
      <% end %>
    </ul>
  <% elsif @videos.first&.key?("snippet") %> <!-- YouTube APIからの検索結果の表示 -->
    <% @videos.each do |video| %>
      <div class="video-item">
        <%= image_tag video["snippet"]["thumbnails"]["medium"]["url"], alt: video["snippet"]["title"] %>
        <h3><%= video["snippet"]["title"] %></h3>
        <p><%= video["snippet"]["description"] %></p>
        <p>Published at: <%= video["snippet"]["publishedAt"].to_time.strftime("%B %d, %Y") %></p>
        <%= link_to '再生する', video_path(id: video["id"]["videoId"]), class: 'play-link' %>
      </div>
    <% end %>
  <% end %>
<% else %>
  <p>No videos found.</p>
<% end %>

<%= link_to 'Add New Video', new_video_path %>
