<!-- 動画のタイトルを表示 -->
<h1><%= @video_details.title || @video.title %></h1>

<!-- 動画の説明文を表示 -->
<p>
  <strong>Description:</strong>
  <%= @video_details.description %>
</p>

<!-- お気に入りボタンの追加 -->
<% if user_signed_in? %>
  <% if current_user&.favorited?(@video) %>
    <%= link_to 'Remove from Favorites', video_favorite_path(@video), method: :delete, class: 'btn btn-danger' %>
  <% else %>
    <%= link_to 'Add to Favorites', video_favorite_path(@video), method: :post, class: 'btn btn-primary' %>
  <% end %>
<% end %>

<!-- お気に入り一覧ページへのリンクを追加 -->
<p>
  <%= link_to 'お気に入り一覧', favorites_path %>
</p>

<!-- 動画の埋め込み表示 -->
<iframe width="560" height="315" src="https://www.youtube.com/embed/<%= @video_details.video_id %>" frameborder="0" allowfullscreen></iframe>

<!-- 感想入力フォームの直前にエラーメッセージを表示 -->
<% if @review&.errors&.any? %>
  <ul>
    <% @review.errors.full_messages.each do |message| %>
      <li><%= message %></li>
    <% end %>
  </ul>
<% end %>

<!-- 感想入力フォームの追加 -->
<h2>あなたの感想</h2>
<%= form_for [@video, Review.new], data: { turbo: "false" } do |f| %>
  <%= f.hidden_field :video_id, value: @video.id %>
  <%= f.text_area :body, rows: 5, placeholder: "ここに感想を入力してください" %>
  <div class="submit-button">
    <%= f.submit "感想を投稿する", class: "btn btn-primary" %>
  </div>
<% end %>

<!-- 感想の一覧表示 -->
<h2><%= link_to '感想一覧', reviews_path %></h2>
<% @reviews.each do |review| %>
  <div class="review">
    <p><%= review.body %></p>
    <% if current_user == review.user %>
      <p>
        <%= link_to 'Edit', edit_video_review_path(@video, review) %> |
      </p>
    <% end %>
    <small>Posted on <%= review.created_at.strftime('%Y-%m-%d %H:%M:%S') %></small>
  </div>
<% end %>

<!-- 動画一覧ページへ戻るリンクを表示 -->
<p>
  <%= link_to 'Back to All Videos', videos_path %>
</p>
